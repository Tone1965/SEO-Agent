<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Agent Workshop - AI-Powered Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Dark theme with colorblind-friendly palette */
        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #262626;
            --bg-tertiary: #333333;
            --text-primary: #f5f5f5;
            --text-secondary: #d4d4d4;
            --accent-blue: #60a5fa;
            --accent-green: #4ade80;
            --accent-orange: #fb923c;
            --accent-purple: #c084fc;
            --accent-yellow: #fbbf24;
            --accent-red: #f87171;
            --border-color: #404040;
        }
        
        /* Light mode */
        body.light-mode {
            --bg-primary: #f9fafb;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f3f4f6;
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --accent-purple: #8b5cf6;
            --accent-yellow: #f59e0b;
            --accent-red: #ef4444;
            --border-color: #e5e7eb;
        }
        
        body.light-mode .gradient-bg {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.85) 0%, rgba(139, 92, 246, 0.85) 100%),
                        url('https://cdn.pixabay.com/photo/2018/05/08/08/44/artificial-intelligence-3382507_1280.jpg') center/cover;
        }
        
        body.light-mode .glass-effect {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }
        
        .agent-tool {
            transition: all 0.3s ease;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
        }
        .agent-tool:hover {
            transform: translateY(-2px);
            border-color: var(--accent-blue);
            box-shadow: 0 10px 30px rgba(96, 165, 250, 0.3);
            background: var(--bg-tertiary);
        }
        .agent-tool.active {
            border-color: var(--accent-green);
            background: rgba(74, 222, 128, 0.15);
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.2);
        }
        .output-panel {
            max-height: 400px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--border-color) var(--bg-tertiary);
        }
        .output-panel::-webkit-scrollbar {
            width: 8px;
        }
        .output-panel::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }
        .output-panel::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }
        .gradient-bg {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.92) 0%, rgba(15, 23, 42, 0.92) 100%),
                        url('https://cdn.pixabay.com/photo/2018/05/08/08/44/artificial-intelligence-3382507_1280.jpg') center/cover;
            border-bottom: 2px solid var(--accent-blue);
            position: relative;
            min-height: 120px;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Colorblind-friendly status indicators */
        .status-idle { background-color: #666666; }
        .status-running { background-color: var(--accent-orange); }
        .status-complete { background-color: var(--accent-green); }
        .status-error { background-color: var(--accent-red); }
        
        /* Custom scrollbar for the entire page */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 6px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Input styling */
        input, select, textarea {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }
        input:focus, select:focus, textarea:focus {
            border-color: var(--accent-blue);
            outline: none;
            box-shadow: 0 0 0 3px rgba(92, 158, 255, 0.2);
        }
        
        /* Button hover effects */
        button {
            transition: all 0.2s ease;
        }
        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
    </style>
</head>
<body class="min-h-screen">
    <div x-data="seoWorkshop()" class="min-h-screen">
        <!-- Header -->
        <header class="gradient-bg text-white shadow-lg">
            <div class="container mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-tools text-3xl"></i>
                        <div>
                            <h1 class="text-2xl font-bold">SEO Agent Workshop</h1>
                            <p class="text-blue-200">AI-Powered Tools at Your Command</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button @click="showMode = 'workshop'" 
                                :class="showMode === 'workshop' ? 'bg-white/20' : 'bg-white/10'"
                                class="px-4 py-2 rounded-lg transition-colors hover:bg-white/25">
                            <i class="fas fa-hammer mr-2"></i>Workshop Mode
                        </button>
                        <button @click="showMode = 'auto'" 
                                :class="showMode === 'auto' ? 'bg-white/20' : 'bg-white/10'"
                                class="px-4 py-2 rounded-lg transition-colors hover:bg-white/25">
                            <i class="fas fa-robot mr-2"></i>Auto Mode
                        </button>
                        <button @click="toggleTheme()" 
                                class="bg-white/10 px-4 py-2 rounded-lg transition-colors hover:bg-white/25">
                            <i :class="darkMode ? 'fas fa-sun' : 'fas fa-moon'" class="mr-2"></i>
                            <span x-text="darkMode ? 'Light' : 'Dark'"></span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Workshop Area -->
        <main class="container mx-auto px-6 py-8">
            <!-- Project Setup -->
            <div class="glass-effect rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold mb-4 flex items-center">
                    <i class="fas fa-project-diagram mr-2 text-blue-600"></i>
                    Project Setup
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-300 mb-2">Business Type</label>
                        <input x-model="project.businessType" type="text" 
                               placeholder="e.g., Plumbing Services"
                               class="w-full border rounded-lg px-4 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-300 mb-2">Location</label>
                        <input x-model="project.location" type="text" 
                               placeholder="e.g., Austin, TX"
                               class="w-full border rounded-lg px-4 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-300 mb-2">Keywords</label>
                        <input x-model="project.keywords" type="text" 
                               placeholder="plumber, emergency plumbing"
                               class="w-full border rounded-lg px-4 py-2">
                    </div>
                </div>
            </div>

            <!-- Workshop Mode -->
            <div x-show="showMode === 'workshop'" class="space-y-6">
                <!-- Agent Tools Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Left Column: Agent Tools -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-bold flex items-center text-gray-100">
                            <i class="fas fa-toolbox mr-2 text-purple-400"></i>
                            AI Agent Tools
                        </h3>
                        
                        <template x-for="agent in agents" :key="agent.id">
                            <div @click="selectAgent(agent)" 
                                 :class="selectedAgent?.id === agent.id ? 'active' : ''"
                                 class="agent-tool rounded-lg p-4 cursor-pointer shadow-lg hover:shadow-2xl">
                                <div class="flex items-start justify-between">
                                    <div class="flex-1">
                                        <div class="flex items-center mb-2">
                                            <i :class="agent.icon" class="text-2xl mr-3" 
                                               :style="`color: ${agent.color}`"></i>
                                            <h4 class="font-bold" :class="darkMode ? 'text-gray-100' : 'text-gray-800'" x-text="agent.name"></h4>
                                        </div>
                                        <p class="text-sm mb-3" :class="darkMode ? 'text-gray-300' : 'text-gray-600'" x-text="agent.description"></p>
                                        
                                        <!-- Agent Controls -->
                                        <div class="flex items-center space-x-2">
                                            <button @click.stop="runAgent(agent)" 
                                                    :disabled="!canRunAgent(agent)"
                                                    class="bg-blue-600/80 hover:bg-blue-700 disabled:bg-gray-700 disabled:text-gray-500 text-white px-3 py-1 rounded text-sm transition-all">
                                                <i class="fas fa-play mr-1"></i>Run
                                            </button>
                                            <button @click.stop="configureAgent(agent)" 
                                                    class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm transition-all">
                                                <i class="fas fa-cog mr-1"></i>Configure
                                            </button>
                                            <span x-show="agent.output" class="text-green-400 text-sm">
                                                <i class="fas fa-check-circle mr-1"></i>Complete
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Status Indicator -->
                                    <div class="ml-4">
                                        <div :class="{
                                            'status-idle': agent.status === 'idle',
                                            'status-running': agent.status === 'running',
                                            'status-complete': agent.status === 'complete',
                                            'status-error': agent.status === 'error'
                                        }" class="w-3 h-3 rounded-full"></div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>

                    <!-- Right Column: Output Preview -->
                    <div class="glass-effect rounded-lg shadow-lg p-6">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <i class="fas fa-eye mr-2 text-green-600"></i>
                            Agent Output Preview
                        </h3>
                        
                        <div x-show="!selectedAgent" class="text-gray-400 text-center py-12">
                            <i class="fas fa-mouse-pointer text-4xl mb-4"></i>
                            <p>Select an agent to see its output</p>
                        </div>
                        
                        <div x-show="selectedAgent" class="space-y-4">
                            <div class="border-b pb-2">
                                <h4 class="font-semibold" :class="darkMode ? 'text-gray-100' : 'text-gray-800'" x-text="selectedAgent?.name"></h4>
                                <p class="text-sm" :class="darkMode ? 'text-gray-300' : 'text-gray-600'" x-text="selectedAgent?.description"></p>
                            </div>
                            
                            <div x-show="selectedAgent?.status === 'running'" class="text-center py-8">
                                <i class="fas fa-spinner fa-spin text-3xl text-blue-600 mb-4"></i>
                                <p>Agent is analyzing...</p>
                            </div>
                            
                            <div x-show="selectedAgent?.output" class="output-panel">
                                <pre class="bg-gray-900 p-4 rounded text-sm whitespace-pre-wrap text-gray-300" 
                                     x-text="selectedAgent?.output"></pre>
                            </div>
                            
                            <div x-show="selectedAgent?.output" class="flex space-x-2 pt-4 border-t">
                                <button @click="approveOutput(selectedAgent)" 
                                        class="bg-green-600/80 hover:bg-green-700 text-white px-4 py-2 rounded transition-all">
                                    <i class="fas fa-check mr-2"></i>Approve
                                </button>
                                <button @click="editOutput(selectedAgent)" 
                                        class="bg-yellow-600/80 hover:bg-yellow-700 text-white px-4 py-2 rounded transition-all">
                                    <i class="fas fa-edit mr-2"></i>Edit
                                </button>
                                <button @click="rerunAgent(selectedAgent)" 
                                        class="bg-blue-600/80 hover:bg-blue-700 text-white px-4 py-2 rounded transition-all">
                                    <i class="fas fa-redo mr-2"></i>Re-run
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Workflow Pipeline -->
                <div class="glass-effect rounded-lg shadow-lg p-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-stream mr-2 text-indigo-600"></i>
                        Workflow Pipeline
                    </h3>
                    
                    <div class="flex items-center space-x-2 overflow-x-auto pb-4">
                        <template x-for="(agent, index) in agents" :key="agent.id">
                            <div class="flex items-center">
                                <div :class="{
                                    'bg-green-900/30 border-green-500': agent.status === 'complete' && darkMode,
                                    'bg-green-100 border-green-500': agent.status === 'complete' && !darkMode,
                                    'bg-yellow-900/30 border-yellow-500': agent.status === 'running' && darkMode,
                                    'bg-yellow-100 border-yellow-500': agent.status === 'running' && !darkMode,
                                    'bg-gray-800 border-gray-600': agent.status === 'idle' && darkMode,
                                    'bg-gray-200 border-gray-400': agent.status === 'idle' && !darkMode,
                                    'text-green-400': agent.status === 'complete' && darkMode,
                                    'text-green-700': agent.status === 'complete' && !darkMode,
                                    'text-yellow-400': agent.status === 'running' && darkMode,
                                    'text-yellow-700': agent.status === 'running' && !darkMode,
                                    'text-gray-300': agent.status === 'idle' && darkMode,
                                    'text-gray-700': agent.status === 'idle' && !darkMode
                                }" class="border-2 rounded-lg px-3 py-2 text-sm whitespace-nowrap">
                                    <i :class="agent.icon" class="mr-1"></i>
                                    <span x-text="agent.name"></span>
                                </div>
                                <i x-show="index < agents.length - 1" 
                                   class="fas fa-arrow-right mx-2 text-gray-400"></i>
                            </div>
                        </template>
                    </div>
                    
                    <div class="mt-4 flex space-x-2">
                        <button @click="runWorkflow()" 
                                class="bg-purple-600/80 hover:bg-purple-700 text-white px-4 py-2 rounded transition-all">
                            <i class="fas fa-play-circle mr-2"></i>Run Workflow
                        </button>
                        <button @click="saveWorkflow()" 
                                class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded transition-all">
                            <i class="fas fa-save mr-2"></i>Save Progress
                        </button>
                        <button @click="resetWorkflow()" 
                                class="bg-red-600/80 hover:bg-red-700 text-white px-4 py-2 rounded transition-all">
                            <i class="fas fa-times-circle mr-2"></i>Reset
                        </button>
                    </div>
                </div>
            </div>

            <!-- Auto Mode (Original) -->
            <div x-show="showMode === 'auto'" class="glass-effect rounded-lg shadow-lg p-8">
                <div class="text-center py-12">
                    <i class="fas fa-robot text-6xl text-blue-600 mb-4"></i>
                    <h3 class="text-2xl font-bold mb-4">Automatic Mode</h3>
                    <p class="text-gray-600 mb-6">Run all 10 agents automatically with one click</p>
                    <button @click="runAutoMode()" 
                            class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-8 rounded-lg transition-all transform hover:scale-105">
                        <i class="fas fa-rocket mr-2"></i>
                        Generate Complete Website
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
        function seoWorkshop() {
            return {
                showMode: 'workshop',
                selectedAgent: null,
                darkMode: true,
                project: {
                    businessType: '',
                    location: '',
                    keywords: ''
                },
                agents: [
                    {
                        id: 1,
                        name: 'Market Scanner',
                        description: 'Analyzes competition and market landscape',
                        icon: 'fas fa-search',
                        color: '#3b82f6',
                        status: 'idle',
                        output: null,
                        config: {
                            depth: 'medium',
                            includeIndirect: true
                        }
                    },
                    {
                        id: 2,
                        name: 'Opportunity Analyzer',
                        description: 'Finds gaps and opportunities in the market',
                        icon: 'fas fa-bullseye',
                        color: '#10b981',
                        status: 'idle',
                        output: null,
                        dependencies: [1]
                    },
                    {
                        id: 3,
                        name: 'Blueprint Generator',
                        description: 'Creates website structure and sitemap',
                        icon: 'fas fa-drafting-compass',
                        color: '#f59e0b',
                        status: 'idle',
                        output: null,
                        dependencies: [1, 2]
                    },
                    {
                        id: 4,
                        name: 'Content Architect',
                        description: 'Plans content strategy and topics',
                        icon: 'fas fa-sitemap',
                        color: '#8b5cf6',
                        status: 'idle',
                        output: null,
                        dependencies: [3]
                    },
                    {
                        id: 5,
                        name: 'Content Generator',
                        description: 'Writes SEO-optimized content',
                        icon: 'fas fa-pen-fancy',
                        color: '#ef4444',
                        status: 'idle',
                        output: null,
                        dependencies: [4]
                    },
                    {
                        id: 6,
                        name: 'SEO Optimizer',
                        description: 'Optimizes for search engines',
                        icon: 'fas fa-chart-line',
                        color: '#06b6d4',
                        status: 'idle',
                        output: null,
                        dependencies: [5]
                    },
                    {
                        id: 7,
                        name: 'Design System',
                        description: 'Creates visual design and branding',
                        icon: 'fas fa-palette',
                        color: '#ec4899',
                        status: 'idle',
                        output: null,
                        dependencies: [3]
                    },
                    {
                        id: 8,
                        name: 'Code Generator',
                        description: 'Builds the actual website code',
                        icon: 'fas fa-code',
                        color: '#14b8a6',
                        status: 'idle',
                        output: null,
                        dependencies: [5, 6, 7]
                    },
                    {
                        id: 9,
                        name: 'Quality Assurance',
                        description: 'Tests and validates everything',
                        icon: 'fas fa-check-double',
                        color: '#f97316',
                        status: 'idle',
                        output: null,
                        dependencies: [8]
                    },
                    {
                        id: 10,
                        name: 'Deployment Agent',
                        description: 'Prepares for launch',
                        icon: 'fas fa-rocket',
                        color: '#6366f1',
                        status: 'idle',
                        output: null,
                        dependencies: [9]
                    }
                ],

                selectAgent(agent) {
                    this.selectedAgent = agent;
                },

                canRunAgent(agent) {
                    // Check if project info is filled
                    if (!this.project.businessType || !this.project.location || !this.project.keywords) {
                        return false;
                    }
                    
                    // Check dependencies
                    if (agent.dependencies) {
                        for (let depId of agent.dependencies) {
                            const dep = this.agents.find(a => a.id === depId);
                            if (!dep || dep.status !== 'complete') {
                                return false;
                            }
                        }
                    }
                    
                    return agent.status !== 'running';
                },

                async runAgent(agent) {
                    if (!this.canRunAgent(agent)) return;
                    
                    agent.status = 'running';
                    this.selectedAgent = agent;
                    
                    try {
                        const response = await fetch('/api/run-agent', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                agent_id: agent.id,
                                agent_name: agent.name,
                                project: this.project,
                                dependencies: agent.dependencies ? 
                                    agent.dependencies.map(id => {
                                        const dep = this.agents.find(a => a.id === id);
                                        return { id: dep.id, output: dep.output };
                                    }) : [],
                                config: agent.config || {}
                            })
                        });
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            agent.output = result.output;
                            agent.status = 'complete';
                        } else {
                            agent.status = 'error';
                            agent.output = 'Error: ' + result.error;
                        }
                    } catch (error) {
                        agent.status = 'error';
                        agent.output = 'Error: ' + error.message;
                    }
                },

                configureAgent(agent) {
                    // Show configuration modal
                    alert(`Configure ${agent.name} settings here`);
                },

                approveOutput(agent) {
                    agent.approved = true;
                    alert(`Output approved for ${agent.name}`);
                },

                editOutput(agent) {
                    const newOutput = prompt('Edit the output:', agent.output);
                    if (newOutput !== null) {
                        agent.output = newOutput;
                        agent.edited = true;
                    }
                },

                rerunAgent(agent) {
                    agent.status = 'idle';
                    agent.output = null;
                    this.runAgent(agent);
                },

                async runWorkflow() {
                    for (let agent of this.agents) {
                        if (this.canRunAgent(agent) && agent.status !== 'complete') {
                            await this.runAgent(agent);
                            // Wait a bit between agents
                            await new Promise(resolve => setTimeout(resolve, 1000));
                        }
                    }
                },

                saveWorkflow() {
                    const workflowData = {
                        project: this.project,
                        agents: this.agents.map(a => ({
                            id: a.id,
                            status: a.status,
                            output: a.output,
                            approved: a.approved,
                            edited: a.edited
                        })),
                        timestamp: new Date().toISOString()
                    };
                    
                    localStorage.setItem('seo-workshop-save', JSON.stringify(workflowData));
                    alert('Workflow saved!');
                },

                resetWorkflow() {
                    if (confirm('Reset all agent outputs?')) {
                        this.agents.forEach(agent => {
                            agent.status = 'idle';
                            agent.output = null;
                            agent.approved = false;
                            agent.edited = false;
                        });
                    }
                },

                runAutoMode() {
                    window.location.href = '/frontend/index.html';
                },

                toggleTheme() {
                    this.darkMode = !this.darkMode;
                    document.body.classList.toggle('light-mode');
                    localStorage.setItem('theme', this.darkMode ? 'dark' : 'light');
                },

                init() {
                    // Load saved theme preference
                    const savedTheme = localStorage.getItem('theme');
                    if (savedTheme === 'light') {
                        this.darkMode = false;
                        document.body.classList.add('light-mode');
                    }
                }
            }
        }
    </script>
</body>
</html>